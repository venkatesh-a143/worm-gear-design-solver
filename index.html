<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Worm Gear Auto Design Solver</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body { font-family: Segoe UI, Arial, sans-serif; background: #f8f8fa; padding: 0 2em; }
h1, h2 { color: #303050; }
.section { background: #fff; border-radius: 8px; padding: 1.5em 2em; margin: 2em 0; box-shadow: 0 2px 12px #0001; }
label { display: inline-block; width: 215px; vertical-align: top; margin-bottom: 0.2em; }
input, select { width: 185px; margin-bottom: 0.65em; }
input[type="number"] { text-align:right; }
.results { background: #e4ffe7; padding: 1.25em 2em; border-radius: 8px; margin-top: 2em; }
.warn { color: #bb0404; font-weight: bold;}
.mat-table { width: 92%; background: #fafad4; font-size: 0.97em; border-collapse: collapse; margin-bottom:.7em;}
.mat-table th, .mat-table td { border: 1px solid #eee; padding: 2px 7px; }
select { width: 187px; }
button { font-size:1.1em; padding:0.4em 1.35em; border-radius:4px; background:#374ea3; color:#fff; border:none;}
button:hover { background:#203179; cursor:pointer;}
@media (max-width: 600px) {
.section { padding: 1em; }
label, input, select { width: 100%; }
.mat-table { width: 100%; }
}
</style>
</head>
<body>
<h1>Worm Gear Auto Design Solver</h1>
<form id="worm-gear-form" autocomplete="off" onsubmit="event.preventDefault(); solve();">
<div class="section">
<h2>1&#xFE0F;&#x20E3; Inputs</h2>
<label>Drive type (worm/gear):</label>
<select id="drive"><option>worm</option><option>gear</option></select><br>
<label>Worm starts z1:</label>
<input type="number" id="z1" step="1" min="1" value="2"><br>
<label>Gear teeth z2:</label>
<input type="number" id="z2" step="1" min="1"><br>
<label>Velocity ratio i:</label>
<input type="number" id="i_val" step="any"><br>
<label>Input speed N1 (rpm):</label>
<input type="number" id="N1" step="any"><br>
<label>Output speed N2 (rpm):</label>
<input type="number" id="N2" step="any"><br>
<label>Center distance a (mm):</label>
<input type="number" id="a_input" step="any"><br>
<label>Worm diameter d1 (mm):</label>
<input type="number" id="d1_input" step="any"><br>
<label>Gear diameter d2 (mm):</label>
<input type="number" id="d2_input" step="any"><br>
<label>Module m (mm):</label>
<input type="number" id="m_input" step="any"><br>
<label>Power P (kW):</label>
<input type="number" id="P" step="any" value="0"><br>
<label>Pressure Angle:</label>
<select id="pa_choice">
<option value="">Auto</option>
<option value="1">20&#xB0;</option>
<option value="2">14.5&#xB0;</option>
<option value="3">20&#xB0; Stub</option>
</select><br>
<label>Friction &#x3BC; (blank &#x2192; auto):</label>
<input type="number" id="mu_input" step="any"><br>
</div>
<div class="section">
<h2>2&#xFE0F;&#x20E3; Material</h2>
<b>Material options:</b>
<table class="mat-table">
<tr><th>#</th><th>Material</th><th>&#x3C3;d</th><th>BHN</th></tr>
</table>
<label>Worm Material:</label>
<select id="worm_mat_choice"></select><br>
<span id="worm_manual" style="display:none">
<label>Enter &#x3C3;d1 for Worm (MPa):</label><input type="number" id="sigma_d1" step="any"><br>
<label>Enter BHN1 for Worm:</label><input type="number" id="bhn1" step="any"><br>
</span>
<label>Gear Material:</label>
<select id="gear_mat_choice"></select><br>
<span id="gear_manual" style="display:none">
<label>Enter &#x3C3;d2 for Gear (MPa):</label><input type="number" id="sigma_d2" step="any"><br>
<label>Enter BHN2 for Gear:</label><input type="number" id="bhn2" step="any"><br>
</span>
<label>Load factor K (blank &#x2192; 0.549):</label>
<input type="number" id="K" step="any"><br>
</div>
<div style="text-align:center;margin:2em 0;">
<button type="submit">Solve</button>
</div>
</form>
<div class="results" id="results" style="display:none"></div>
<script>
const mat_db = {
"1":["Cast Iron Grade 20",47.1,200],
"2":["Cast Iron Grade 25",56.4,220],
"3":["Cast Iron Grade 35",56.4,225],
"4":["Cast Iron Grade 35 (Heat treated)",78.5,300],
"5":["Cast steel, 0.20%C, untreated",138.3,180],
"6":["Cast steel, 0.20%C, heat treated",193.2,250],
"7":["Bronze",68.7,80],
"8":["Phosphor gear bronze",82.4,100],
"9":["Manganese bronze",138.3,100],
"10":["Aluminium bronze",152.0,180],
"11":["Forged steel, about 0.30%C (untreated)",172.6,150],
"12":["Forged steel, about 0.30%C (heat treated)",220.0,200],
"13":["Steel, C30 (heat treated)",220.6,300],
"14":["Steel, C40, untreated",207.0,150],
"15":["Steel, C45, untreated",233.4,200],
"16":["Alloy steel, case hardened",345.2,650],
"17":["Cr-Ni Steel, about 0.45%C, heat treated",462.0,400],
"18":["Cr-Va steel, about 0.45%C, heat treated",516.8,450],
"19":["Rawhide, Fabroil, etc.",41.2,null],
"20":["Plastic",58.8,null],
"21":["Laminated phenolic materials (Bakelite, Micarta, Celoron)",41.2,null],
"22":["Laminated steel (silent material)",82.4,null],
"23":["Manual Input",null,null]
};
const std_modules = [1,1.25,1.5,2,2.5,3,4,5,6,8,10,12,16,20,25,32,40];
for(let i=1;i<=23;++i) {
const [mat,sd,bhn]=mat_db[String(i)];
let opttxt=i==23?'Manual Input':
mat+' (sd='+sd+(sd?' MPa':'')+', BHN='+(bhn!=null?bhn:'-')+')';
let opt=new Option(opttxt,String(i));
document.getElementById('worm_mat_choice').add(opt.cloneNode(true));
document.getElementById('gear_mat_choice').add(opt.cloneNode(true));
if(i!=23)
document.querySelector('.mat-table').innerHTML+='<tr><td>'+i+'</td><td>'+mat+'</td><td>'+(sd!=null?sd:'-')+'</td><td>'+(bhn!=null?bhn:'-')+'</td></tr>';
}
document.getElementById('worm_mat_choice').value="8";
document.getElementById('gear_mat_choice').value="8";
document.getElementById('worm_mat_choice').onchange=function(e){
document.getElementById('worm_manual').style.display=e.target.value=="23"?'inline':'none';
};
document.getElementById('gear_mat_choice').onchange=function(e){
document.getElementById('gear_manual').style.display=e.target.value=="23"?'inline':'none';
};
function getNum(id) {
var v=document.getElementById(id).value.trim();
let val = v===""?null:parseFloat(v);
return isNaN(val)?null:val;
}
function round_up_5(x) {
return 5*Math.ceil(x/5.0);
}
function solve() {
let drive=document.getElementById('drive').value||'worm';
let z1=getNum("z1")||2;
let z2=getNum("z2");
let i_val=getNum("i_val");
let N1=getNum("N1");
let N2=getNum("N2");
let a_input=getNum("a_input");
let d1_input=getNum("d1_input");
let d2_input=getNum("d2_input");
let m_input=getNum("m_input");
let P=getNum("P")||0;
let pa_choice=document.getElementById("pa_choice").value;
let phi=pa_choice=="2"?14.5:(pa_choice=="1"||pa_choice=="3"?20.0:null);
let mu_input=getNum("mu_input");
let worm_mat_choice=document.getElementById('worm_mat_choice').value;
let worm_mat_name,sigma_d1,bhn1;
if(worm_mat_choice!="23"){[worm_mat_name,sigma_d1,bhn1]=mat_db[worm_mat_choice];}
else{
worm_mat_name="Custom Worm"; sigma_d1=getNum("sigma_d1");
bhn1=getNum("bhn1");
if(sigma_d1&&!bhn1) bhn1=sigma_d1/0.6;
if(bhn1&&!sigma_d1) sigma_d1=bhn1*0.33;
}
let gear_mat_choice=document.getElementById('gear_mat_choice').value;
let gear_mat_name,sigma_d2,bhn2;
if(gear_mat_choice!="23"){[gear_mat_name,sigma_d2,bhn2]=mat_db[gear_mat_choice];}
else{
gear_mat_name="Custom Gear"; sigma_d2=getNum("sigma_d2"); bhn2=getNum("bhn2");
if(sigma_d2&&!bhn2) bhn2=sigma_d2/0.6;
if(bhn2&&!sigma_d2) sigma_d2=bhn2*0.33;
}
let mat_name=worm_mat_name+' / '+gear_mat_name;
let sigma_d=Math.min(sigma_d1||80,sigma_d2||80);
let avg_bhn=((bhn1||100)+(bhn2||100))/2;
let K=getNum("K")||0.549;
let y=0.1;
let i=i_val||(z2&&z1?z2/z1:null);
if(N2==null && N1 && i) N2=N1/i;
if(N1==null && N2 && i) N1=N2*i;
if(z2==null && i && z1) z2=Math.round(i*z1);
let n1=N1/60, n2=N2/60;
let d1_user_locked=d1_input!==null;
let d2_user_locked=d2_input!==null;
let a_user_locked=a_input!==null;
let d1,d2,a;
if(a_input!==null && d1_input===null && d2_input===null){
a=round_up_5(a_input);
d1=round_up_5(Math.pow(a,0.875)/1.466);
d2=round_up_5(2*a-d1);
}else if(d1_input!==null && m_input!==null){
d1=round_up_5(d1_input); d2=round_up_5(m_input*z2); a=round_up_5((d1+d2)/2);
}else if(d2_input!==null && m_input!==null){
d2=round_up_5(d2_input); d1=round_up_5(m_input*z1); a=round_up_5((d1+d2)/2);
}else if(d1_input!==null && d2_input!==null){
d1=round_up_5(d1_input); d2=round_up_5(d2_input);
a=round_up_5((d1+d2)/2);
}else{
a=round_up_5((P>0&&i!==null)?Math.pow((P*(i+5))/0.02905,1/1.7):50);
d1=round_up_5(Math.pow(a,0.875)/1.466);
d2=round_up_5(2*a-d1);
}
let b=round_up_5(Math.pow(a,0.875)/2);
let gamma_w_rad=Math.atan((1.0*z1)/d1);
let v=(Math.PI*d2*N2)/60000;
let Cv=6.1/(6.1+v);
let Mt=P*1000*60/(2*Math.PI*N2);
let Ft=2*Mt/(d2/1000);
let m=m_input, m_theoretical=null;
let user_locked_module=m_input!==null;
if(m_input===null){
m_theoretical=Ft/(sigma_d*b*y*Math.PI*Cv);
let m_candidates=std_modules.filter(function(mm){return mm>=m_theoretical;});
m=m_candidates.length?m_candidates[0]:std_modules[std_modules.length-1];
}
let idx=std_modules.indexOf(m);
let looped=false;
let gamma_w_deg,gamma_g_rad,gamma_g_deg,vr,mu,Fs,Fw;
while(true){
gamma_w_rad=Math.atan((m*z1)/d1);
gamma_g_rad=Math.atan((m*z2)/d2);
gamma_w_deg=gamma_w_rad*180/Math.PI;
gamma_g_deg=gamma_g_rad*180/Math.PI;
if(phi==null) phi=20.0;
vr=(Math.PI*d1*N1)/(60*1000*Math.cos(gamma_w_rad));
if(mu_input!==null) mu=mu_input;
else mu=vr<=2.8?0.0422/Math.pow(vr,0.28):0.025+(3.281*vr)/1000;
Fs=sigma_d*b*y*Math.PI*m;
Fw=d2*b*K;
if(Fw>=Fs) break;
if(user_locked_module) break;
if(idx>=std_modules.length-1) break;
m=std_modules[++idx];looped=true;
}
let tan_gamma=Math.tan(gamma_w_rad);
let cot_gamma=1/tan_gamma;
let cos_gamma=Math.cos(gamma_w_rad);
let theta_rad=Math.atan(tan_gamma*cos_gamma);
let cos_theta=Math.cos(theta_rad);
let eta;
if(drive==="worm")
eta=(cos_theta-mu*tan_gamma)/(cos_theta+mu*cot_gamma);
else
eta=(cos_theta-mu*cot_gamma)/(cos_theta+mu*tan_gamma);
let Fn=Ft/(cos_theta*cos_gamma);
let Qg=mu*Fn*vr/cos_gamma;
let Qd=1000*P*(1-eta);
let theta=phi*Math.PI/180, gamma=gamma_w_rad, mu_val=mu;
let Q_=Ft*(Math.cos(theta)*Math.sin(gamma)+mu_val*Math.cos(gamma))/(Math.cos(theta)*Math.cos(gamma)-mu_val*Math.sin(gamma));
let R_=Ft*Math.sin(theta)/(Math.cos(theta)*Math.cos(gamma)-mu_val*Math.sin(gamma));
let Fx_worm=Q_, Fy_worm=R_, Fz_worm=Ft;
let Fx_gear=Ft, Fy_gear=R_, Fz_gear=Q_;
let res = '<h2>FINAL DESIGN RESULTS</h2>'+
'<b>Material:</b> '+mat_name+'<br>'+
'<b>Power:</b> '+P+' kW<br>'+
'<b>Velocity Ratio i:</b> '+(i? i.toFixed(3) : 'n/a')+'<br>'+
'<h4>Speeds</h4>'+
'Input Speed N1: '+(N1||'-')+' rpm<br>'+
'Output Speed N2: '+(N2!=null?N2.toFixed(2):'-')+' rpm<br>'+
'Worm speed n1: '+(n1!=null?n1.toFixed(4):'-')+' rps<br>'+
'Worm wheel speed n2: '+(n2!=null?n2.toFixed(4):'-')+' rps<br>'+
'<h4>Geometry</h4>'+
'Center Distance a: '+a+' mm<br>'+
'Worm Diameter d1: '+d1+' mm<br>'+
'Gear Diameter d2: '+d2+' mm<br>'+
'Face Width b: '+b+' mm<br>'+  
'<h4>Module</h4>';
if(m_theoretical===null)
res+='User Given Module m: '+m;
else
res+='Theoretical Module m_th: <b>'+m_theoretical.toFixed(4)+'</b><br>Selected Standard Module m: <b>'+m+'</b>';
res+='<h4>Angles</h4>'+
'Lead Angle (Worm): '+(gamma_w_deg!=null?gamma_w_deg.toFixed(3):'-')+' deg<br>'+  
'Lead Angle (Gear): '+(gamma_g_deg!=null?gamma_g_deg.toFixed(3):'-')+' deg<br>'+  
'Pressure Angle: '+(phi!=null?phi.toFixed(3):'-')+' deg<br>'+  
'<h4>Velocities</h4>'+  
'Pitch Line Velocity v: '+(v!=null?v.toFixed(5):'-')+' m/s<br>'+  
'Relative Velocity vr: '+(vr!=null?vr.toFixed(5):'-')+' m/s<br>'+  
'<h4>Forces</h4>'+  
'Tangential Load Ft: '+(Ft!=null?Ft.toFixed(2):'-')+' N<br>'+  
'Beam Strength Fs: '+(Fs!=null?Fs.toFixed(2):'-')+' N<br>'+  
'Wear Load Fw: '+(Fw!=null?Fw.toFixed(2):'-')+' N<br>'+  
'<h4>Friction and Efficiency</h4>'+  
'Velocity Factor Cv: '+(Cv!=null?Cv.toFixed(4):'-')+'<br>'+  
'Friction: '+(mu!=null?mu.toFixed(5):'-')+'<br>'+  
'Efficiency: '+((eta*100)!=null?(eta*100).toFixed(2):'-')+' %<br>'+  
'<h4>Thermal</h4>'+  
'Heat Generated Qg: '+(Qg!=null?Qg.toFixed(2):'-')+' W<br>'+  
'Heat Dissipated Qd: '+(Qd!=null?Qd.toFixed(2):'-')+' W<br>'+  
(Qd<Qg?'<div class="warn">Warning: Artificial cooling required</div>':'')+  
'<h4>Force Components (Design Data Handbook)</h4>'+  
'Worm Axial Thrust Fx_worm: '+(Fx_worm!=null?Fx_worm.toFixed(2):'-')+' N<br>'+  
'Worm Radial Force Fy_worm: '+(Fy_worm!=null?Fy_worm.toFixed(2):'-')+' N<br>'+  
'Worm Tangential Force Fz_worm: '+(Fz_worm!=null?Fz_worm.toFixed(2):'-')+' N<br>'+  
'Gear Tangential Force Fx_gear: '+(Fx_gear!=null?Fx_gear.toFixed(2):'-')+' N<br>'+  
'Gear Radial Force Fy_gear: '+(Fy_gear!=null?Fy_gear.toFixed(2):'-')+' N<br>'+  
'Gear Axial Thrust Fz_gear: '+(Fz_gear!=null?Fz_gear.toFixed(2):'-')+' N<br>'+  
'<h3 style="color:#189b3c;margin-top:16px;">DESIGN COMPLETE</h3>';
if(looped&&user_locked_module)
res+='<div class="warn">WARNING: User module is NOT safe (Fw < Fs)</div>';
document.getElementById('results').innerHTML=res;
document.getElementById('results').style.display='';
}
</script>
</body>
</html>